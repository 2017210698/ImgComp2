


%% High PSNR patch size fit
TPSNR = 32;
PatchSize = 4:5;
expLevel  = 1:2;

NNZD = -1*ones(length(expLevel),length(PatchSize));
NNZG = -1*ones(size(NNZD));
BPP = -1*ones(size(NNZD));

 for pp=1:length(PatchSize)
    for ll=1:length(expLevel) 
        [tNNZD,tNNZG,tPSNR,tBPP] = Pmain(expLevel(ll),PatchSize(pp),TPSNR);
        if((tPSNR-TPSNR)<0.1)
            NNZD(ll,pp) = tNNZD;
            NNZG(ll,pp) = tNNZG;
            BPP (ll,pp) = tBPP;
        end
    end
 end
 
 save('dataSimul/dataHighRes');
  
 

%% plot result


% plotting
COL = copper(length(expLevel));
m=1;n=5;
figure; 

% plotting BPP
subplot(m,n,1)
for ll=1:length(expLevel)
    plot(PatchSize,BPP(ll,:),'Color',COL(ll,:));hold on;
end
title('BPP vs PatchSize');
xlabel('PatchSize');
ylabel('BPP');

% plotting NNZD, NNZG
COL1 = copper(length(expLevel));
COL2 = winter(length(expLevel));
subplot(m,n,2)
for ll=1:length(expLevel)
    plot(PatchSize,NNZD(ll,:),'Color',COL1(ll,:));hold on;
    plot(PatchSize,NNZG(ll,:),'Color',COL2(ll,:));hold on;
end
title('NNZD(copeer),NNZG(winter) vs PatchSize');
xlabel('PatchSize');
ylabel('NNZ');

% plotting TOTAL NNZ
subplot(m,n,3)
TOTNNZ = NNZD+NNZG; 
for ll=1:length(expLevel)
    plot(PatchSize,TOTNNZ(ll,:),'Color',COL(ll,:));hold on;
end
title('NNZ TOT vs PatchSize');
xlabel('PatchSize');
ylabel('NNZ');

% plotting legened COL1
subplot(m,n,4)
for ll=1:length(expLevel)
    plot(expLevel(ll),expLevel(ll),'.','MarkerSize',30,'Color',COL1(ll,:));hold on;
end
title('legened NNZD');
xlabel('level');


% plotting legened
subplot(m,n,5)
for ll=1:length(expLevel)
    plot(expLevel(ll),expLevel(ll),'.','MarkerSize',30,'Color',COL2(ll,:));hold on;
end


